# Bandit Configuration Template (YAML Format)
# Copy this file to your project root as "bandit.yaml"
# Run with: bandit -c bandit.yaml -r .
#
# Documentation: https://bandit.readthedocs.io/en/latest/config.html

# Directories to exclude from scanning
exclude_dirs:
  - tests
  - test
  - venv
  - env
  - .venv
  - __pycache__
  - .git
  - build
  - dist
  - node_modules
  - .eggs
  - *.egg-info

# Tests to skip (list of test IDs to exclude)
# Use this to suppress false positives
skips:
  - B101  # assert_used
  - B601  # paramiko_calls

# Only run specific tests (if specified, only these will run)
# Comment out to run all tests except those in skips
# tests:
#   - B201  # flask_debug_true
#   - B301  # pickle
#   - B302  # marshal
#   - B602  # subprocess_popen_with_shell_equals_true

# ============================================================================
# PLUGIN-SPECIFIC SETTINGS (Advanced)
# ============================================================================

# Configure the subprocess shell injection detector
any_other_function_with_shell_equals_true:
  no_shell:
    - os.execl
    - os.execle
    - os.execlp
    - os.execlpe
    - os.execv
    - os.execve
    - os.execvp
    - os.execvpe

# ============================================================================
# COMMON CONFIGURATION EXAMPLES
# ============================================================================

# Example 1: Production-ready strict scanning
# exclude_dirs:
#   - tests
#   - venv
# skips: []
# tests:
#   - B201  # flask_debug_true
#   - B301  # pickle
#   - B302  # marshal
#   - B303  # md5
#   - B304  # insecure_cipher
#   - B305  # insecure_cipher_mode
#   - B307  # eval
#   - B501  # request_with_no_cert_validation
#   - B502  # ssl_with_bad_version
#   - B504  # ssl_with_no_version
#   - B505  # weak_cryptographic_key
#   - B506  # yaml_load
#   - B602  # subprocess_popen_with_shell_equals_true
#   - B603  # subprocess_without_shell_equals_true
#   - B604  # any_other_function_with_shell_equals_true
#   - B605  # start_process_with_a_shell
#   - B608  # hardcoded_sql_expressions
#   - B609  # linux_commands_wildcard_injection

# Example 2: Development-friendly (balanced)
# exclude_dirs:
#   - tests
#   - test
#   - venv
#   - docs
# skips:
#   - B101  # assert_used (common in tests)
#   - B110  # try_except_pass
#   - B112  # try_except_continue
#   - B404  # import_subprocess (too noisy)
#   - B603  # subprocess_without_shell_equals_true (false positives)
#   - B607  # start_process_with_partial_path

# Example 3: Web application focus
# exclude_dirs:
#   - tests
#   - venv
#   - migrations
# tests:
#   - B201  # flask_debug_true
#   - B308  # mark_safe
#   - B501  # request_with_no_cert_validation
#   - B506  # yaml_load
#   - B602  # subprocess_popen_with_shell_equals_true
#   - B604  # any_other_function_with_shell_equals_true
#   - B605  # start_process_with_a_shell
#   - B608  # hardcoded_sql_expressions
#   - B609  # linux_commands_wildcard_injection
#   - B610  # django_extra_used
#   - B611  # django_rawsql_used
#   - B701  # jinja2_autoescape_false
#   - B702  # use_of_mako_templates
#   - B703  # django_mark_safe

# Example 4: Cryptography focus
# exclude_dirs:
#   - tests
#   - venv
# tests:
#   - B303  # md5
#   - B304  # insecure_cipher
#   - B305  # insecure_cipher_mode
#   - B324  # hashlib_insecure_functions
#   - B413  # import_pycrypto
#   - B501  # request_with_no_cert_validation
#   - B502  # ssl_with_bad_version
#   - B503  # ssl_with_bad_defaults
#   - B504  # ssl_with_no_version
#   - B505  # weak_cryptographic_key

# ============================================================================
# NOTES
# ============================================================================
# 1. This file must be explicitly specified: bandit -c bandit.yaml -r .
# 2. YAML format is more readable than INI for complex configurations
# 3. Test IDs can be found in REFERENCE.md or via: bandit -l
# 4. Use verbose mode to debug: bandit -c bandit.yaml -r . -v
